# T10.1.39 – UI & Logik Improvements

## Teil 1: Overtemp Cooling Boost
- Bei Overtemp:
  - FAN230V = ON
  - FAN230V_SLOW = OFF
- Rückkehr bei Heater-ON:
  - FAN230V = OFF
  - FAN230V_SLOW = ON

## Teil 2: TopBar2 (Lauftext)
### Layout
- Breite: UI_SCREEN_WIDTH - 2*UI_SIDE_PADDING
- Höhe: 32px
- Abgerundet, immer sichtbar

### Funktion
- Lauftext für Systemmeldungen
- Zentriert bei kurzem Text
- Marquee bei langem Text
- Timeout blendet Text aus, Frame bleibt

## Ergebnis
- Bessere Nutzerführung
- Klare Warn- & Statusmeldungen
- Erweiterbare UI-Komponente

## T10.1.39c – Overtemperature-Konsolidierung & Fan-Strategie

### Ziel
Saubere Trennung zwischen sicherheitsrelevanter Logik (Host) und Darstellung (UI).
Der Host ist alleinige Autorität für Temperatur-abhängige Entscheidungen.

### Architekturentscheidung
- **Host**
  - bewertet Temperaturen
  - setzt Overtemperature-Status
  - steuert HEATER, FAN230V und FAN230V_SLOW
- **UI**
  - wertet keine Temperaturen aus
  - trifft keine Aktuatorentscheidungen
  - visualisiert ausschließlich den vom Host gemeldeten Zustand

Zur expliziten Kommunikation wurde das Feld  
`runtimeState.hostOvertempActive` eingeführt.

---

### Overtemperature-Verhalten (Host)

**Trip-Bedingung**

`tempCurrent >= tempTarget + tolerance`

Aktionen:
- HEATER → OFF
- FAN230V (FAST) → ON
- FAN230V_SLOW → OFF

Ziel: schnelle aktive Abkühlung.

---

### Recovery-Verhalten (Host)

**Recovery-Bedingung**

`tempCurrent <= tempTarget - tolerance`

Aktionen:
- FAN230V (FAST) → OFF
- FAN230V_SLOW → ON
- HEATER folgt anschließend wieder der normalen Hysterese-Logik

---

### UI-Verhalten

- Die UI liest ausschließlich `runtimeState`
- `hostOvertempActive` dient als reines **Statussignal**
- TopBar2 zeigt Systemzustände (z. B. „Overtemperature – Cooling“)
- **Keine** UI-Logik greift steuernd in Lüfter oder Heizung ein

---

### Ergebnis

- klare Verantwortlichkeiten
- keine doppelte Fan-Logik mehr
- keine impliziten Seiteneffekte
- stabile Grundlage für Bugfix-Phase (T10.1.40)